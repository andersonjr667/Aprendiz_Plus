(()=>{function e(e,t="info",o=4e3){let n=document.getElementById("toastContainer");n||(n=document.createElement("div"),n.id="toastContainer",n.style.position="fixed",n.style.top="16px",n.style.right="16px",n.style.zIndex=9999,document.body.appendChild(n));const r=document.createElement("div");r.textContent=e,r.style.marginTop="8px",r.style.padding="10px 14px",r.style.borderRadius="6px",r.style.color="#fff",r.style.boxShadow="0 2px 10px rgba(0,0,0,0.08)",r.style.background="success"===t?"#16a34a":"error"===t?"#dc2626":"#2563eb",n.appendChild(r),setTimeout(()=>{r.style.opacity="0",setTimeout(()=>r.remove(),300)},o)}!function(e){const t="aprendizplus_token";function o(){try{return localStorage.getItem(t)}catch(e){return null}}function n(){try{localStorage.removeItem(t)}catch(e){}}e.Auth={setToken:function(e){if(!e)return n();try{localStorage.setItem(t,e)}catch(e){console.warn("Não foi possível salvar token",e)}},getToken:o,removeToken:n,isAuthenticated:function(){return!!o()}}}(window),window.login=async function(t){t.preventDefault();const o=t.target,n={email:o.email.value,password:o.password.value};e("Entrando...","info");try{const t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"}),o=await t.json();t.ok&&o.ok?(o.token&&window.Auth.setToken(o.token),e("Login realizado com sucesso","success"),window.location="/"):e(o.error||"Erro ao fazer login","error")}catch(t){e(t.message||"Erro de rede","error")}},window.register=async function(t){t.preventDefault();const o=t.target,n={name:o.name.value,email:o.email.value,password:o.password.value,type:o.type.value};e("Registrando...","info");try{const t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"}),o=await t.json();if(t.ok&&o.ok)e("Conta criada com sucesso. Redirecionando para login...","success"),window.location="/login?registered=true";else{e(o.errors&&o.errors[0]&&o.errors[0].msg||o.error||"Erro ao criar conta","error")}}catch(t){e(t.message||"Erro de rede","error")}}})();